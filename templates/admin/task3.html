{% extends 'admin/master.html' %}
 {% block head %}
<link href="{{url_for('static',filename='css/index.css')}}" rel="stylesheet" xmlns="http://www.w3.org/1999/html">
<link href="{{url_for('static',filename='css/userClustering.css')}}" rel="stylesheet" xmlns="http://www.w3.org/1999/html">

<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="http://code.jquery.com/jquery-1.10.2.js"></script>
<script src="http://code.jquery.com/ui/1.11.2/jquery-ui.js"></script>
  <script src="{{url_for('static',filename='js/pages/dashboard3.js')}}"></script>

  {% endblock head%}
{% block body %}

<!-- User characteristics -->


<!-- Content Header (Page header) -->

<section class="content">
  <!-- Small boxes (Stat box) -->

  <!-- /.row -->
  <!-- Main row -->
  <div class="row">
    <!-- Left col -->
    <section class="col-lg-5 " id="cols">
      <!-- Custom tabs (Charts with tabs)-->

      <!-- /.nav-tabs-custom -->
 <!-- WordClouds box -->
      <div class="box box-solid bg-light-blue-gradient">
        <div class="box-header">
          <!-- tools box -->
          <!-- /. tools -->


          <h3 class="box-title">
            Gender Prediction
          </h3>
        </div>

        <div class="box-body" >
          <img class="center" width="100%" height="350" src="static/img/genderPredictionCM.png">

          <p align="justify" >
            In order to enrich the demographic information about user profiles, a gender prediction module was implemented.Out of 5549 user profiles collected, only 875 of them contained a gender feature. Whatâ€™s more, reviews from 2263 users were collected and incorporated for the gender pre-diction task. The gender prediction module starts with the data preprocessing, in which the reviews of each user are aggregated. Next, text reviews are transformed into lower-case representation and are stemmed while stopwords and digits are removed. The text is then transformed into vector representation using CountVectorizer method. Out of the 875 known user profiles, 600 are used for the training phase,while 275 are used for testing. We utilized a Random ForestClassifier for the binary classification and the evaluation metrics are accuracy score and F1-score. The classifier achieved 0.67 accuracy and 0.57 F1-score.
          </p>
                  <table>
              <tr>
                <td>Accuracy</td>
                <td>0.67</td>
              </tr>
              <tr>
                <td>F1</td>
                <td>0.57</td>
              </tr>
            </table>
        </div>
      </div>
    </section>
    <section class="col-lg-5 " id="cols">
      <!-- Custom tabs (Charts with tabs)-->

      <!-- /.nav-tabs-custom -->
 <!-- WordClouds box -->
      <div class="box box-solid bg-light-blue-gradient">
        <div class="box-header">
          <!-- tools box -->
          <!-- /. tools -->


          <h3 class="box-title">
            Age Prediction
          </h3>
        </div>

        <div class="box-body" >
          <img class="center" width="100%" height="350" src="static/img/ageGroupCM.png">
            <p align="justify" >
                In order to build a Machine Learning model that could be able to predict age group
                that each user belongs to, we integrated some basic features, demographics characteristics
                extracted from user profiles, but also some features extracted from their 50 most recent
                reviews.
          </p>
            <p align="justify">
                A sample of the dataset was selected as a test-set to evaluate the performance of our model.
                It is worth noting that the selection of test-set was done with the stratification approach
                in order to have an equal representation ratio of each class according to the whole Dataset.
                Due to the Class Imbalance of our Dataset, SMOTE method was applied for oversampling
                examples of the minority classes. Then, Tomek Links was also removed in order to get rid
                of mutual nearest neighbors of different classes.
            </p>
            <p align="justify">
                SVM with an one-vs-one adaptation was used in order to tackle the multi-class nature of our problem.
                In the illustration above we can see the confusion matrix for SVM predictions and miss-classifications.
                As we can notice in Figure \ref{cm} there are many miss-classifications between the 35-49 and 50-64
                classes. Our model struggles to identify whether an example from 35-49 class belongs to 3rd or 4th class.
            </p>

            <p align="justify">
                In Table below we can see the performance of our model separately in the 4 different classes. As we expected from the confusion matrix observations, the 35-49 class achieved the lower performance score according to Precision, Recall and F1 metrics.
            </p>

             <table>
              <tr>
                <th>Class</th>
                <th>Precision</th>
                <th>Recall</th>
                <th>F1</th>
                  <th>Support</th>
              </tr>
              <tr>
                <td>17-24</td>
                <td>0.60</td>
                <td>0.50</td>
                <td>0.57</td>
                <td>4</td>
              </tr>
              <tr>
                <td>25-34</td>
                <td>0.60</td>
                <td>0.62</td>
                <td>0.61</td>
                <td>24</td>
              </tr>
              <tr>
                <td>35-49</td>
                <td>0.47</td>
                <td>0.41</td>
                <td>0.44</td>
                <td>44</td>
              </tr>
              <tr>
                <td>50-64</td>
                <td>0.62</td>
                <td>0.70</td>
                <td>0.66</td>
                <td>47</td>
              </tr>
            </table>

            <p align="justify">
                In the next table balanced accuracy score captures the global performance of our model both in train and test set.

            </p>


            <table>
              <tr>
                <td>Train Balanced Accuracy</td>
                <td>0.79</td>
              </tr>
              <tr>
                <td>Test Balanced Accuracy</td>
                <td>0.56</td>
              </tr>
            </table>

        </div>
      </div>
    </section>
    <!-- /.Left col -->
    <!-- right col (We are only adding the ID to make the widgets sortable)-->

    <!-- right col -->
  </div>
  <!-- /.row (main row) -->

</section>
<!-- /.content -->
<div class="modal" id = "modalUser" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">Info</h4>
      </div>
      <div class="modal-body">
        <p>To group users in communities according to opinions they express during their interaction with  TripAdvisor platform we applied the following procedure. By using the last 50 reviews for 2.500 users, we utilized Natural Language Processing techniques to group them according to the content of their reviews. Firstly, text of each user reviews is organized in a single integrated corpus. Then some preprocessing techniques are applied on this corpus for text cleaning purposes: </p>
      <ol>
<!-- Start of ordered list. Paragraphs cannot contain lists. Insert </p> -->
<li>tokenization</li>
      <li>remove punctuation</li>
      <li>remove English stop-words</li>
      <li>convert tokens to lowercase</li>
      <li>remove suffixes with stemming</li></ol>
<p>Next, by utilizing the TFIDF approach we converted the unified corpus to a vector format. Consequently, PCA method is applied to reduce the dimensionality of our Dataset.</p>
        <p>Finally, utilizing vector representation of each user, we applied the k-Means algorithm to group users into clusters. Because we can not know in advance the ideal size for k we executed the algorithm repeatedly and evaluated its performance based on the metrics of silhouette score and sum squared error.</p>
        <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
    </div>
</div>

{% endblock body %}